<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>简历</title>
	<link rel="stylesheet" type="text/css" href="css/main.css">
	    <meta charset="UTF-8">
	<title>JS读取和导出excel示例</title>
	<meta name="description" content="使用sheetjs读取和导出excel示例">
    <style type="text/css">
	table {
	    border-collapse: collapse;
	}
	th, td {
	    border: solid 1px #6D6D6D;
	    padding: 5px 10px;
	}
	.mt-sm {margin-top: 8px;}
	body {
		background: #f4f4f4;
		padding: 0;
		margin: 0;
	}
	.container {
		width: 1024px;
		margin: 0 auto;
		background: #fff;
		padding: 20px;
		min-height: 100vh;
	}
    </style>
</head>
<body>
<aside>
	<a class="cur_a"><span>首页</span></a>
	<a><span>介绍</span></a>
	<a><span>个人开支</span></a>
</aside>	
<section class="page_one" id="page1">
	<nav>
		<div class="nav_wrap">
			<div class="resume_logo">
				<a href="index.html">Resume</a>
			</div>
			<div class="nav_bar">
				<ul class="nav_bar_ul">
					<li><a href="index.html">Home</a></li>
					<li><a href="bingzhuangtu.html">查看饼状图</a></li> 
					<li><a href="#">page3</a></li>
					<li><a href="#">page4</a></li>
					<li><a href="#">page5</a></li>
				</ul>
			</div>
		</div>
	</nav>
	
	<div class="cen_con">
		<div class="portrait">
            <img onmousemove="this.src='images/22.png'"/ onmouseout="this.src='images/portrait1.jpg'"/ src="images/portrait1.jpg">
        </div>
		<div class="cen_text">
			<h2>世上只有想不通的人，没有走不通的路。</h2>
			<hr>
			<h3> 唐峤</h3>
			<h3>35320172200216</h3>
			<h3>路在自己脚下</h3>
			<h3>18xxxxxxxxx</h3>
		</div>
		
	</div>
	<div class="down_arrow">
		<a class="scroll"><span></span></a> 
	</div>
	
</section>


<section class="page_three" id="page2">
	<div class="con_wrap">
		<div class="tit_wrap">
			<h1>自我介绍</h1>
			<div class="scissors">
				<span></span>
			</div>
			<h2>代码，我们眼中的世界，别人眼中的天书。</h2>	
		</div>
		<div class="skill_con">
			<div class="canvas_wrap">
				<div class="canvas_con">
					<div class="text_con">
						<p class="percent">90%</p>
						<p class="chart_title">把妹</p>
					</div>
					<canvas id="html5" width=160 height=160></canvas>
				</div>
				<div class="canvas_con">
					<div class="text_con">
						<p class="percent">90%</p>
						<p class="chart_title">声控</p>
					</div>
					<canvas id="css3" width=160 height=160></canvas>
				</div>
				<div class="canvas_con">
					<div class="text_con">
						<p class="percent">75%</p>
						<p class="chart_title">运动</p>
					</div>
					<canvas id="js" width=160 height=160></canvas>
				</div>
				<div class="canvas_con">
					<div class="text_con">
						<p class="percent">80%</p>
						<p class="chart_title">幽默</p>
					</div>
					<canvas id="jq" width=160 height=160></canvas>
				</div>
				<div class="canvas_con">
					<div class="text_con">
						<p class="percent">70%</p>
						<p class="chart_title">睿智</p>
					</div>
					<canvas id="bs" width=160 height=160></canvas>
				</div>
				<div class="canvas_con">
					<div class="text_con">
						<p class="percent">80%</p>
						<p class="chart_title">热情</p>
					</div>
					<canvas id="ps" width=160 height=160></canvas>
				</div>
			</div>
			<div class="text_wrap">
				<p>1.  大家好 我叫唐峤 我是一个超级活泼的人噢~</p>
				<p>2.  不要被我看似文静或者内敛的外面给欺骗了噢~我的胜任座右铭是：态度决定一切。</p>
				<p>3.  因为我觉得一个人到底会不会成功，态度才是最关键的因素。</p>
				<p>4.  我喜欢看什么什么书~ 曾经记得那里有这么一句话~《要牛逼一点的》我觉得它是能给我的人生一点启示的话</p>
				<p>5.  所以拿出来与大家分享，希望大家也能从中得到一点帮助。其他千篇一律的话我就不说了。</p>
				<p>6.  我希望在将来的四年里面大家能慢慢发现我的好，我愿意与大家成为即使毕业多年仍能彼此挂念的朋友</p>
				<p>7.  说到自己，真正了解自己的人有多少?除了可以对着镜子精细地描绘出自己的相貌，内在的东西实在难以琢磨，就像中国一样，外皮是社会主义，里面不知道搞的啥。</p>
				<p>8.  ~谢谢大家~</p>
			</div>	
		</div>
		
	</div>
	<div class="down_arrow">
		<a class="scroll"><span></span></a> 
	</div>
</section>

<section class="page_five" id="page3">
	<div class="con_wrap">
		<div class="tit_wrap">
			<h1>个人账单</h1>

			<div class="scissors">
				<span></span>
			</div>	
			<h2>勤俭节约正能量, 奋发图强好动力。</h2>
		</div>
<div class="container">

		<h2><a href="javascript:selectFile()"><font size="4" color="blue">选择读取的数据excel</font></a></h2>
		<div class="mt-sm">
			<input type="file" id="file" style="display:none;" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"/>
			
	
		</div>
		
		<p>结果输出：</p>
		<div id="result" contenteditable></div>

		
	</div>
	<script type="text/javascript" src="./js/jquery.min.js"></script>
	<script type="text/javascript" src="./js/xlsx.core.min.js"></script>
	<script type="text/javascript">

	function selectFile() {
		document.getElementById('file').click();
	}

	// 读取本地excel文件
	function readWorkbookFromLocalFile(file, callback) {
		var reader = new FileReader();
		reader.onload = function(e) {
			var data = e.target.result;
			var workbook = XLSX.read(data, {type: 'binary'});
			if(callback) callback(workbook);
		};
		reader.readAsBinaryString(file);
	}


	function readWorkbook(workbook) {
		var sheetNames = workbook.SheetNames; // 工作表名称集合
		var worksheet = workbook.Sheets[sheetNames[0]]; // 这里我们只读取第一张sheet
		var csv = XLSX.utils.sheet_to_csv(worksheet);
		document.getElementById('result').innerHTML = csv2table(csv);
	}

	// 将csv转换成表格
	function csv2table(csv)
	{
		var html = '<table>';
		var rows = csv.split('\n');
		rows.pop(); // 最后一行没用的
		rows.forEach(function(row, idx) {
			var columns = row.split(',');
			columns.unshift(idx+1); // 添加行索引
			if(idx == 0) { // 添加列索引
				html += '<tr>';
				for(var i=0; i<columns.length; i++) {
					html += '<th>' + (i==0?'':String.fromCharCode(65+i-1)) + '</th>';
				}
				html += '</tr>';
			}
			html += '<tr>';
			columns.forEach(function(column) {
				html += '<td>'+column+'</td>';
			});
			html += '</tr>';
		});
		html += '</table>';
		return html;
	}



	

	$(function() {
		document.getElementById('file').addEventListener('change', function(e) {
			var files = e.target.files;
			if(files.length == 0) return;
			var f = files[0];
			if(!/\.xlsx$/g.test(f.name)) {
				alert('仅支持读取xlsx格式！');
				return;
			}
			readWorkbookFromLocalFile(f, function(workbook) {
				readWorkbook(workbook);
			});
		});
		loadRemoteFile('./sample/test.xlsx');
	});



	</script>
		<div class="contact_detail">
		
			<div class="contact_info">
				<form action="" method="get">
				<label>
					<input type="text" id="username" placeholder="你的名字" required="">
					<p  id="check_username"></p>
				</label>
				<label>
					<input type="text" id="usermail" placeholder="你的邮箱" required="">
					<p id="check_usermail"></p>
				</label>	
				<label>
					<input type="text" id="usertheme" placeholder="主题" required="" maxlength="25">
					<p id="check_usertheme"></p>
				</label>	
				<label>
					<textarea id="usercon" placeholder="内容" required=""></textarea>
					<p id="check_usercon" ></p>
				</label>					
					<button>发送</button>
				</form>
			</div>
		</div>
	</div>	
</section>
<div style="text-align:center;">
</div>
</body>
<script type="text/javascript" src="js/main.js"></script>
</html>
